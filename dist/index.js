var t,i=require("react"),s=(t=i)&&"object"==typeof t&&"default"in t?t.default:t;function n(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,(Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}var e={display:"inline-block"},r=function(t){function i(i){var s;return(s=t.call(this,i)||this).str=(s.props.children||"").replaceAll(" "," "),s}n(i,t);var r=i.prototype;return r.componentDidMount=function(){this.props.parent||(this.init(),this.run())},r.componentWillUnmount=function(){clearInterval(this.interval)},r.init=function(){var t;this.iteration=!this.props.rewind||null!==(t=this.props.parent)&&void 0!==t&&t.props.rewind?0:this.str.length-1,this.stopped=!1,this.setState({display:null}),this.onStart()},r.run=function(){var t,i=this,s=this.props.pause||(null===(t=this.props.parent)||void 0===t?void 0:t.props.pause)||0;setTimeout(function(){i.updateInterval()},s)},r.updateInterval=function(){var t,i,s=this;clearInterval(this.interval);var n=" "!=this.str[this.iteration]?this.props.pace||(null===(t=this.props.parent)||void 0===t?void 0:t.props.pace)||40:this.props.whiteSpacePace||(null===(i=this.props.parent)||void 0===i?void 0:i.props.whiteSpacePace)||this.props.pace||40;this.interval=setInterval(function(){return s.play()},n)},r.checkForWhiteSpace=function(){(" "==this.str[this.iteration]&&" "!=this.lastChar||" "!=this.str[this.iteration]&&" "==this.lastChar)&&this.updateInterval(),this.lastChar=this.str[this.iteration]},r.play=function(){var t=this;if(this.checkForWhiteSpace(),!this.stopped){var i,n,r=this.props.stamp||(null===(i=this.props.parent)||void 0===i?void 0:i.props.stamp),o=this.props.rewind||(null===(n=this.props.parent)||void 0===n?void 0:n.props.rewind);if(r)this.setState({display:s.createElement("span",{style:e,className:this.props.charClassName,key:Date.now()},this.str)},function(){t.iteration=o?0:t.props.children.length-1,t.onChar(),t.stop()});else{var p,a=this.str.substr(0,this.iteration+1).split("");o?((p=a.map(function(i,n){return s.createElement("span",{className:t.props.charClassName,style:{display:"inline-block",animation:"none"},key:n},i)})).pop(),p.push(s.createElement("span",{style:e,className:this.props.charClassName,key:Date.now()},a.slice(-1)))):p=a.map(function(i,n){return s.createElement("span",{style:e,className:t.props.charClassName,key:n},i)}),this.setState({display:p},function(){t.iteration+=o?-1:1,o&&t.iteration<-1||!o&&t.iteration>t.str.length?t.stop():t.onChar()})}}},r.replay=function(){this.init(),this.run()},r.show=function(){this.setState({display:this.str.split("").map(function(t,i){return s.createElement("span",{style:e,key:i},t)})})},r.stop=function(){this.props.loop?this.replay():(this.stopped=!0,this.onStop())},r.onStart=function(){var t,i;null===(t=(i=this.props).onStart)||void 0===t||t.call(i,this)},r.onChar=function(){var t,i,s,n,e,r,o=(null===(t=this.props.parent)||void 0===t?void 0:t.props.rewind)||this.props.rewind?this.str[this.iteration+1]:this.str[this.iteration-1];null===(i=(s=this.props).onChar)||void 0===i||i.call(s,o,this),null===(n=this.props.parent)||void 0===n||null===(e=(r=n.props).onChar)||void 0===e||e.call(r,o,this.props.parent)},r.onStop=function(){var t,i,s,n;clearInterval(this.interval),null===(t=(i=this.props).onStop)||void 0===t||t.call(i,this),null===(s=this.props)||void 0===s||null===(n=s.parent)||void 0===n||n.play()},r.render=function(){var t;return s.createElement("div",{className:this.props.className,style:{display:this.props.block?"block":"inline-block"}},(null===(t=this.state)||void 0===t?void 0:t.display)||" ")},i}(i.Component),o=function(t){function i(s){var n;return(n=t.call(this,s)||this).textRefs=[],s.first&&(i.first=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)),n.init(),n}n(i,t),i.play=function(t){var s;null===(s=i.typos.get(t))||void 0===s||s.replay()},i.stop=function(t){var s;null===(s=i.typos.get(t))||void 0===s||s.stop()};var e=i.prototype;return e.componentDidMount=function(){var t=this;this.props.stop||Array.from(i.typos.values()).some(function(i){return i.props.next==t.name})&&i.first!=this||(this.init(),this.play())},e.init=function(){var t=this;this.initiated=!1,this.textRefs.forEach(function(t){var i;return null===(i=t.current)||void 0===i?void 0:i.init()}),this.texts=s.Children.map(this.props.children,function(i){var n=s.createRef();return t.textRefs.push(n),s.createElement(r,Object.assign({},i.props,{ref:n,parent:t,rewind:t.props.rewind||i.props.rewind}),i.props.children||"")}),this.iteration=this.props.rewind?1==this.texts.length?0:this.texts.length-1:0,this.name=this.props.name||"_"+Math.random().toString(36).substr(2,9),i.typos.set(this.name,this)},e.play=function(){if(this.initiated||(this.onStart(),this.initiated=!0),this.props.rewind&&this.iteration<0||!this.props.rewind&&this.iteration>this.texts.length-1)this.stop();else{var t,i,s,n;if(this.props.rewind)for(var e=this.iteration;e>=0;e--){var r;null===(r=this.textRefs[e].current)||void 0===r||r.show()}null===(t=this.textRefs[this.iteration])||void 0===t||null===(i=t.current)||void 0===i||i.init(),null===(s=this.textRefs[this.iteration])||void 0===s||null===(n=s.current)||void 0===n||n.run(),this.iteration+=this.props.rewind?-1:1,this.onText()}},e.replay=function(){this.init(),this.play()},e.stop=function(){this.onStop()},e.onStart=function(){var t,i;null===(t=(i=this.props).onStart)||void 0===t||t.call(i,this)},e.onText=function(){var t,i,s,n,e=this.props.rewind?null===(t=this.textRefs[this.iteration+1])||void 0===t?void 0:t.current:null===(i=this.textRefs[this.iteration-1])||void 0===i?void 0:i.current;e&&(null===(s=(n=this.props).onText)||void 0===s||s.call(n,e,this))},e.onStop=function(){var t,s,n,e;null===(t=(s=this.props).onStop)||void 0===t||t.call(s,this),this.props.next&&(null===(n=i.typos.get(this.props.next))||void 0===n||n.init(),null===(e=i.typos.get(this.props.next))||void 0===e||e.play())},e.render=function(){return s.createElement("div",{className:this.props.className,style:{display:"inline-block"}},this.texts)},i}(i.Component);o.typos=new Map,exports.Text=r,exports.Typo=o;
