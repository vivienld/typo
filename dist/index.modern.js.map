{"version":3,"file":"index.modern.js","sources":["../src/text.tsx","../src/typo.tsx"],"sourcesContent":["import React, { Component } from 'react'\nimport Typo from './typo';\n\nconst defaultPace = 40;\nconst defaultPause = 0;\n\nconst spanStyle = {\n    display: 'inline-block'\n}\n\ninterface Props {\n    pace?: number;\n    pause?: number;\n    block?: boolean;\n    stamp?: boolean;\n    rewind?: boolean;\n    parent?: Typo;\n    charClassName?: string;\n    className?: string;\n    onStart?: (text: Text) => void;\n    onPlay?: (text: Text) => void;\n    onStop?: (text: Text) => void;\n}\n\ninterface State {\n    display: JSX.Element[] | JSX.Element;\n}\n\nexport default class Text extends Component<Props, State> {\n\n    private initiated: boolean;\n    str: string;\n    interval: NodeJS.Timeout;\n    iteration: number;\n\n    constructor(props: Props) {\n        super(props);\n        this.str = (this.props.children as string || '').replaceAll(' ', '\\xa0');\n        this.iteration = !this.props.rewind ? 0 : this.str.length - 1;\n    }\n\n    componentDidMount() {\n        if (!this.props.parent) {\n            this.run();\n        }\n    }\n\n\n    run() {\n        const pause = this.props.parent?.props.pause || this.props.pause || defaultPause;\n        const pace = this.props.parent?.props.pace || this.props.pace || defaultPace;\n\n        if (!this.initiated) {\n            this.onStart();\n            this.initiated = true;\n            this.interval = setTimeout(() => { this.play(); this.run(); }, pause);\n        } else {\n            this.interval = setInterval((() => this.play()), pace)\n        }\n    }\n\n    play() {\n        const stamp = this.props.parent?.props.stamp || this.props.stamp;\n        const rewind = this.props.parent?.props.rewind || this.props.rewind;\n\n        if (!stamp) {\n            const chars = this.str.substr(0, this.iteration + 1).split('');\n            let display;\n\n            if (rewind) {\n                display = chars.map((char, i) => {\n                    return <span style={spanStyle} key={i}>{char}</span>\n                });\n                display.pop();\n                display.push(<span style={spanStyle} className={this.props.charClassName} key={Date.now()}>{chars.slice(-1)}</span>)\n            } else {\n                display = chars.map((char, i) => {\n                    return <span style={spanStyle} className={this.props.charClassName} key={i}>{char}</span>\n                });\n            }\n            this.setState({ display }, () => {\n\n                this.iteration += rewind ? -1 : 1;\n                if (\n                    (rewind && this.iteration < -1) ||\n                    (!rewind && this.iteration > this.str.length)\n                ) {\n                    this.stop();\n                } else {\n                    this.onPlay();\n                }\n            })\n        } else {\n            this.setState({\n                display: <span style={spanStyle} className={this.props.charClassName}>{this.str}</span>\n            }, () => {\n                this.iteration = rewind ? 0 : (this.props.children as string).length - 1;\n                this.onPlay();\n                this.stop();\n            })\n        }\n    }\n\n    show() {\n        this.setState({\n            display: this.str.split('').map((char, i) => <span style={spanStyle} key={i}>{char}</span>)\n        })\n    }\n\n    stop() {\n        clearInterval(this.interval);\n            this.onStop();\n    }\n\n    onStart() {\n        this.props.onStart?.(this);\n    }\n\n    onPlay() {\n        this.props.onPlay?.(this);\n        this.props.parent?.props.onChar?.(this.str[this.iteration + 1], this.props.parent);\n    }\n\n    onStop() {\n        this.props.onStop?.(this);\n        this.props?.parent?.play();\n    }\n\n    render() {\n        return <div className={this.props.className} style={{\n            display: this.props.block ? 'block' : 'inline-block'\n        }}>{this.state?.display}</div>\n    }\n}\n","import React, { Component } from 'react'\nimport Text from './text';\n\ninterface Props {\n    rewind?: boolean;\n    stamp?: boolean;\n    pause?: number;\n    pace?: number;\n    onStart?: (typo: Typo) => void;\n    onPlay?: (typo: Typo) => void;\n    onStop?: (typo: Typo) => void;\n    onChar?: (char: string, typo: Typo) => void;\n}\n\ninterface State {\n    display: JSX.Element[] | JSX.Element;\n}\n\nexport default class Typo extends Component<Props, State> {\n\n    texts: JSX.Element[];\n    textRefs: React.RefObject<Text>[] = [];\n    iteration: number;\n\n    constructor(props: Props) {\n        super(props);\n        this.iteration = !this.props.rewind ? 0 : (this.props.children as string || '').length - 1;\n\n        this.texts = React.Children.map(this.props.children as JSX.Element, child => {\n            let ref = React.createRef<Text>();\n            this.textRefs.push(ref);\n            console.log(child)\n            return <Text {...child.props} ref={ref} parent={this} rewind={this.props.rewind}>{child.props.children || ''}</Text>\n        })\n\n    }\n\n    componentDidMount() {\n        this.onStart();\n        this.run();\n    }\n\n    run() {\n        this.play();\n    }\n\n    play() {\n        if (\n            (this.props.rewind && this.iteration < 0) || (!this.props.rewind && this.iteration > this.texts.length - 1)) {\n            this.stop();\n        } else {\n            if (this.props.rewind) {\n                for (let i = this.iteration; i >= 0; i--) {\n                    this.textRefs[i].current?.show();\n                }\n            }\n            \n            this.textRefs[this.iteration].current?.run();\n            \n            this.iteration += this.props.rewind ? -1 : 1;\n            this.onPlay();\n        }\n    }\n\n    stop() {\n        this.onStop();\n    }\n\n    onStart() {\n        this.props.onStart?.(this);\n    }\n\n    onPlay() {\n        this.props.onPlay?.(this);\n    }\n\n    onStop() {\n        this.props.onStop?.(this);\n    }\n\n    render() {\n        return <React.Fragment>{this.texts}</React.Fragment>\n    }\n}\n"],"names":["defaultPace","defaultPause","spanStyle","display","Text","Component","constructor","props","str","children","replaceAll","iteration","rewind","length","componentDidMount","parent","run","pause","pace","initiated","onStart","interval","setTimeout","play","setInterval","stamp","chars","substr","split","map","char","i","React","style","key","pop","push","className","charClassName","Date","now","slice","setState","stop","onPlay","show","clearInterval","onStop","onChar","render","block","state","Typo","texts","Children","child","ref","createRef","textRefs","console","log","current","Fragment"],"mappings":"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"}