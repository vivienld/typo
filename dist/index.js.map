{"version":3,"file":"index.js","sources":["../src/text.tsx","../src/typo.tsx"],"sourcesContent":["import React, { Component } from 'react'\nimport Typo from './typo';\n\nconst defaultPace = 40;\nconst defaultDelay = 0;\n\nconst spanStyle = {\n    display: 'inline-block'\n}\n\ninterface Props {\n    pace?: number;\n    delay?: number;\n    block?: boolean;\n    stamp?: boolean;\n    rewind?: boolean;\n    parent?: Typo;\n    printClassName?: string;\n    charClassName?: string;\n    textClassName?: string;\n    onStart?: (text: Text) => void;\n    onPlay?: (text: Text) => void;\n    onStop?: (text: Text) => void;\n}\n\ninterface State {\n    display: JSX.Element[] | JSX.Element;\n}\n\nexport default class Text extends Component<Props, State> {\n\n    private initiated: boolean;\n    str: string;\n    interval: NodeJS.Timeout;\n    iteration: number;\n\n    constructor(props: Props) {\n        super(props);\n        this.str = (this.props.children as string || '').replaceAll(' ', '\\xa0');\n    }\n\n    componentDidMount() {\n        this.iteration = !this.props.rewind ? 0 : (this.props.children as string || '').length - 1;\n\n        if (!this.props.parent) {\n            this.run();\n        }\n    }\n\n\n    run() {\n\n        if (!this.initiated) {\n            this.onStart();\n            this.initiated = true;\n            setTimeout(() => { this.play(); this.run(); }, this.props.delay || defaultDelay);\n        } else {\n            this.interval = setInterval((() => this.play()), this.props.pace || defaultPace)\n        }\n    }\n\n    play() {\n\n        if (!this.props.stamp) {\n            const chars = this.str.substr(0, this.iteration + 1).split('');\n            this.setState({\n                display: chars.map((char, i) => {\n                    if (i == chars.length - 1) {\n                        return <span style={spanStyle} className={this.props.printClassName} key={i}>{char}</span>\n                    } else {\n                        return <span style={spanStyle} className={this.props.charClassName} key={i}>{char}</span>\n                    }\n                })\n            }, () => {\n                this.iteration += this.props.rewind ? -1 : 1;\n                if (\n                    (this.props.rewind && this.iteration < -1) ||\n                    (!this.props.rewind && this.iteration > this.str.length)\n                ) {\n                    this.stop();\n                } else {\n                    this.onPlay();\n                }\n            })\n        } else {\n            this.setState({\n                display: <span style={spanStyle} className={this.props.printClassName}>{this.str}</span>\n            }, () => {\n                this.iteration = this.props.rewind ? 0 : (this.props.children as string).length - 1;\n                this.onPlay();\n                this.stop();\n            })\n        }\n    }\n\n    show() {\n        this.setState({\n            display: this.str.split('').map((char, i) => <span style={spanStyle} className={this.props.charClassName} key={i}>{char}</span>)\n        })\n    }\n\n    stop() {\n        clearInterval(this.interval);\n            this.onStop();\n    }\n\n    onStart() {\n        this.props.onStart?.(this);\n    }\n\n    onPlay() {\n        this.props.onPlay?.(this);\n    }\n\n    onStop() {\n        this.props.onStop?.(this);\n        this.props?.parent?.play();\n    }\n\n    render() {\n        return <div className={this.props.textClassName} style={{\n            display: this.props.block ? 'block' : 'inline-block'\n        }}>{this.state?.display}</div>\n    }\n}\n","import React, { Component } from 'react'\nimport Text from './text';\n\ninterface Props {\n    rewind?: boolean;\n    onStart?: (typo: Typo) => void;\n    onPlay?: (typo: Typo) => void;\n    onStop?: (typo: Typo) => void;\n}\n\ninterface State {\n    display: JSX.Element[] | JSX.Element;\n}\n\nexport default class Typo extends Component<Props, State> {\n\n    texts: JSX.Element[];\n    textRefs: React.RefObject<Text>[] = [];\n    iteration: number;\n\n    constructor(props: Props) {\n        super(props);\n        this.iteration = !this.props.rewind ? 0 : (this.props.children as string || '').length - 1;\n\n        this.texts = React.Children.map(this.props.children as JSX.Element, child => {\n            let ref = React.createRef<Text>();\n            this.textRefs.push(ref);\n\n            return <Text {...child.props} ref={ref} parent={this} rewind={this.props.rewind}>{child.props.children}</Text>\n        })\n\n    }\n\n    componentDidMount() {\n        this.onStart();\n        this.run();\n    }\n\n    run() {\n        this.play();\n    }\n\n    play() {\n        if (\n            (this.props.rewind && this.iteration < 0) || (!this.props.rewind && this.iteration > this.texts.length - 1)) {\n            this.stop();\n        } else {\n            if (this.props.rewind) {\n                for (let i = this.iteration; i >= 0; i--) {\n                    this.textRefs[i].current?.show();\n                }\n            }\n\n            this.textRefs[this.iteration].current?.run();\n\n            this.iteration += this.props.rewind ? -1 : 1;\n            this.onPlay();\n        }\n    }\n\n    stop() {\n        this.onStop();\n    }\n\n    onStart() {\n        this.props.onStart?.(this);\n    }\n\n    onPlay() {\n        this.props.onPlay?.(this);\n    }\n\n    onStop() {\n        this.props.onStop?.(this);\n    }\n\n    render() {\n        return <React.Fragment>{this.texts}</React.Fragment>\n    }\n}\n"],"names":["defaultPace","defaultDelay","spanStyle","display","Text","props","str","children","replaceAll","componentDidMount","iteration","rewind","length","parent","run","initiated","onStart","setTimeout","play","delay","interval","setInterval","pace","stamp","chars","substr","split","setState","map","char","i","React","style","className","printClassName","key","charClassName","stop","onPlay","show","clearInterval","onStop","render","textClassName","block","state","Component","Typo","texts","Children","child","ref","createRef","textRefs","push","current","Fragment"],"mappings":"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"}